@startuml
skinparam componentStyle rectangle
skinparam shadowing false
skinparam wrapWidth 220
skinparam defaultTextAlignment center

title FastFoodOnline Component Diagram

package "Client Layer" {
  component "Customer Web App\n(frontend/src, Vite + React)" as Customer
  component "Admin Web App\n(admin/src, Vite + React)" as Admin
}

node "API Server\nbackend/server.js (Express)" as ApiHost {
  component "Express Router Layer\n(routes/*.js)" as Router
  component "JWT Auth Middleware\n(middleware/auth.js)" as Auth

  package "Controller Layer" {
    component "Public Controllers\n(food, user, cart, order)" as CtrlV1
    component "v2 Controllers\n(menu, orders, inventory, shipper,\nbranch, staff, notification, category,\nrestaurant, admin, measurement unit)" as CtrlV2
  }

  package "Domain Services" {
    component "Menu & Catalog Service\n(menuService.js, categoryService.js)" as MenuSvc
    component "Ordering & Payment Service\n(orderService.js)" as OrderSvc
    component "Inventory & Branch Ops Service\n(inventoryService.js,\nbranchService.js, restaurantService.js)" as InvSvc
    component "People & Access Service\n(staffService.js,\nadminAccountService.js,\ncustomerService.js)" as PeopleSvc
    component "Notification Service\n(notificationService.js)" as NotifSvc
  }

  package "Data Access" {
    component "Repositories\n(*Repository.js)" as Repos
    component "Mongoose Models\n(models/*.js)" as Models
  }

  component "Static Media Handler\n(multer uploads â†’ /images)" as Media
  component "Swagger/OpenAPI Publisher\n(swagger-jsdoc + swagger-ui)" as Swagger
}

component "REST/JSON HTTP :4000\n/api/**" as RestPort
component "Static Assets :4000/images" as StaticPort
component "OpenAPI Docs :4000/api-docs" as DocsPort

database "MongoDB Atlas\n(fooddeliverydb cluster)" as Mongo

component "Docker Compose Stack\n(frontend, admin, backend)" as Compose

package "Payment Providers" {
  component "VNPAY Sandbox" as Vnpay
  component "Stripe Checkout" as Stripe
  component "MoMo Gateway" as Momo
}

Customer --> RestPort : HTTPS fetch/cart/order
Admin --> RestPort : HTTPS CRUD

Customer --> StaticPort : load images
Admin --> StaticPort : preview uploads

RestPort --> Router
Router --> CtrlV1
Router --> CtrlV2
Router --> Auth : validate token
Auth --> CtrlV2 : inject req.userId

CtrlV1 --> MenuSvc
CtrlV1 --> OrderSvc
CtrlV1 --> PeopleSvc

CtrlV2 --> MenuSvc
CtrlV2 --> OrderSvc
CtrlV2 --> InvSvc
CtrlV2 --> PeopleSvc
CtrlV2 --> NotifSvc

MenuSvc --> Repos
OrderSvc --> Repos
InvSvc --> Repos
PeopleSvc --> Repos
NotifSvc --> Repos

Repos --> Models
Models --> Mongo : CRUD via Mongoose

Media --> StaticPort
Swagger --> DocsPort

OrderSvc --> Vnpay : create/verify txn
OrderSvc --> Stripe : checkout session
OrderSvc --> Momo : payment init/query

NotifSvc ..> RestPort : /api/v2/notifications

Compose ..> Customer
Compose ..> Admin
Compose ..> ApiHost
Compose ..> Mongo

@enduml
