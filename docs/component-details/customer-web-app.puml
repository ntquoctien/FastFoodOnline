@startuml
skinparam componentStyle rectangle
skinparam shadowing false
skinparam wrapWidth 220
skinparam defaultTextAlignment center

title Customer Web App Component Diagram

package "Customer Web App\n(frontend/src)" {
  component "App Router\n(React Router v6)" as CustomerRouter
  component "StoreContext\n(API client + state\nfrontend/src/context/StoreContext.jsx)" as CustomerStore

  package "Feature Pages" {
    component "Home / Menu\n(frontend/src/pages/Home, Menu)" as HomeMenu
    component "Cart & Checkout\n(frontend/src/pages/Cart,\nPlaceOrder)" as CartCheckout
    component "Auth & Orders\n(frontend/src/pages/Verify,\nMyOrders)" as AuthOrders
  }

  component "UI Shell\n(Navbar, Footer,\nLoginPopup)" as UIShell

  CustomerRouter --> HomeMenu
  CustomerRouter --> CartCheckout
  CustomerRouter --> AuthOrders
  CustomerRouter --> UIShell

  HomeMenu --> CustomerStore
  CartCheckout --> CustomerStore
  AuthOrders --> CustomerStore
  UIShell --> CustomerStore
}

interface "REST/JSON API\nHTTPS :4000/api/v2/**" as RestPort
interface "Legacy API\nHTTPS :4000/api/**" as LegacyPort
interface "Static Media\nHTTPS :4000/images/**" as ImagesPort
component "Browser LocalStorage /\nSessionStorage" as LocalStorage
component "Navigator Geolocation API" as Geolocation
component "Toast Notifications\nreact-toastify" as Toast

CustomerStore --> RestPort
CustomerStore --> LegacyPort
CustomerStore --> LocalStorage
CustomerStore --> Geolocation
CustomerStore --> Toast
HomeMenu --> ImagesPort
UIShell --> ImagesPort

note right of RestPort
  Examples:
  GET /api/v2/menu/default
  POST /api/v2/orders
  GET /api/v2/orders/me
end note

note right of LegacyPort
  Backwards-compat routes:
  /api/cart/**, /api/user/**
end note

note bottom of LocalStorage
  Persist token, cart items,
  preferredBranchId
end note

@enduml
